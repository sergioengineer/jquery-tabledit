//e = "id=" + $($(lcked).parents('tr').children('td')[0]).children('span').html();
var lcked = null; $(document).ready(function(){$(".btn").click(function (e){lcked=e.target;})});
var $jscomp={scope:{},findInternal:function(a,g,f){a instanceof String&&(a=String(a));for(var d=a.length,c=0;c<d;c++){var h=a[c];if(g.call(f,h,c,a))return{i:c,v:h}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,g,f){if(f.get||f.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[g]=f.value)};
$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(a,g,f,d){if(g){f=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var c=a[d];c in f||(f[c]={});f=f[c]}a=a[a.length-1];d=f[a];g=g(d);g!=d&&null!=g&&$jscomp.defineProperty(f,a,{configurable:!0,writable:!0,value:g})}};
$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,f){return $jscomp.findInternal(this,a,f).v}},"es6-impl","es3");if("undefined"===typeof jQuery)throw Error("Tabledit requires jQuery library.");
(function(a){a.fn.Tabledit=function(g){function f(b){var e="";a(d.find(".tabledit-input:not(.tabledit-identifier)")).each(function(){a(this).prop("disabled")||(e = 'id=' + $($(lcked).parents('tr').children('td') [0]).children('span').html()/*e="id="+d.find(a(this)).parents("tr").attr(c.rowIdentifier)*/)});if("delete"==b){var k=a(".tabledit-confirm-button.active");e="id="+k.parents("tr").attr(c.rowIdentifier); if("id=undefined"==e) e = "id=" + $($(lcked).parents('tr').children('td')[0]).children('span').html();k.removeClass("active")}else"delete"!=b&&(e+="&");k=e+d.find(".tabledit-input:not(.tabledit-identifier)").serialize()+"&action="+b+"&table="+d.attr("data-info-table");if(!1===
c.onAjax(b,k))return!1;k=a.post(c.url,k,function(e,d,k){"confirmation"==e.message?b===c.buttons.edit.action||b===c.buttons.add.action?(h.removeClass(c.dangerClass).addClass(c.successClass),a(c.feedbackContainer).html("<div class='alert alert-success'><span>Confirmation</span></div>"),b===c.buttons.add.action&&(h.attr("data-id",e.id),a(c.feedbackContainer).html("<div class='alert alert-success'><span>Confirmation</span></div>")),setTimeout(function(){h.removeClass(c.successClass)},1400)):b===c.buttons["delete"].action&&
a(c.feedbackContainer).html("<div class='alert alert-success'><span>Confirmation</span></div>"):"error"==e.message&&b===c.buttons.add.action?(h.addClass(c.dangerClass),a(c.feedbackContainer).html("<div class='alert alert-danger'><span>Error</span></div>"),setTimeout(function(){h.fadeOut(1E3,function(){a(this).remove()})},2E3)):"error"==e.message&&b===c.buttons.edit.action?(h.addClass(c.dangerClass),a(c.feedbackContainer).html("<div class='alert alert-danger'><span>Error</span></div>")):(a(c.feedbackContainer).html("<p>Something is wrong!</p>"),
console.log("No confirmation or error in data."));c.onSuccess(e,d,k)},"json");k.fail(function(a,e,d){b===c.buttons["delete"].action?(q.removeClass(c.mutedClass).addClass(c.dangerClass),q.find(".tabledit-toolbar button").attr("disabled",!1),q.find(".tabledit-toolbar .tabledit-restore-button").hide()):b!==c.buttons.edit.action&&b!==c.buttons.add.action||h.addClass(c.dangerClass);c.onFail(a,e,d)});k.always(function(){c.onAlways()});return k}if(!this.is("table"))throw Error("Tabledit only works when applied to a table.");
var d=this,c=a.extend(!0,{url:window.location.href,inputClass:"form-control form-control-sm",toolbarClass:"btn-toolbar",groupClass:"btn-group",dangerClass:"bg-danger text-white",warningClass:"bg-warning",successClass:"bg-success text-white",mutedClass:"text-muted",eventType:"click",feedbackContainer:"#feedback",rowIdentifier:"data-id",rowCounter:"#",hideCounter:!1,autoFocus:!0,editButton:!0,deleteButton:!0,saveButton:!0,restoreButton:!0,addButton:!0,buttons:{edit:{"class":"btn btn-sm btn-outline-secondary",
html:'<span class="fa fa-edit"></span>',action:"edit"},add:{"class":"btn btn-sm btn-outline-secondary",html:'<span class="fa fa-plus"></span>',action:"add"},"delete":{"class":"btn btn-sm btn-outline-secondary",html:'<span class="fa fa-trash"></span>',action:"delete"},save:{"class":"btn btn-sm btn-success",html:"Save"},cancel:{"class":"btn btn-sm btn-warning",html:"Cancel"},restore:{"class":"btn btn-sm btn-warning",html:"Restore",action:"restore"},confirm:{"class":"btn btn-sm btn-danger",html:"Confirm"}},
onDraw:function(){},onSuccess:function(){},onFail:function(){},onAlways:function(){},onAjax:function(){}},g),h="undefined",q="undefined",p={identifier:function(){c.hideCounter&&d.find("th:nth-child("+parseInt(c.columns.identifier[0])+1+"), tbody td:nth-child("+parseInt(c.columns.identifier[0])+1+")").hide();d.find("tbody td:nth-child("+(parseInt(c.columns.identifier[0])+1)+")").each(function(){var b='<span class="tabledit-span tabledit-identifier">'+a(this).text()+"</span>",e='<input class="tabledit-input tabledit-identifier" type="hidden" name="'+
c.columns.identifier[1]+'" value="'+a(this).text()+'" disabled>';a(this).html(b+e)})},editable:function(){for(var b=0;b<c.columns.editable.length;b++)d.find("tbody td:nth-child("+(parseInt(c.columns.editable[b][0])+1)+")").each(function(){var e=a(this).text();c.editButton||a(this).css("cursor","pointer");var d='<span class="tabledit-span">'+e+"</span>";if("undefined"!==typeof c.columns.editable[b][2]){var f='<select class="tabledit-input '+c.inputClass+'" name="'+c.columns.editable[b][1]+'" style="display: none;" disabled>';
a.each(jQuery.parseJSON(c.columns.editable[b][2]),function(a,b){f=e===b?f+('<option value="'+a+'" selected>'+b+"</option>"):f+('<option value="'+a+'">'+b+"</option>")});f+="</select>"}else f='<input class="tabledit-input '+c.inputClass+'" type="text" name="'+c.columns.editable[b][1]+'" value="'+a(this).text()+'" style="display: none;" disabled>';a(this).html(d+f);a(this).addClass("tabledit-view-mode")})},toolbar:function(){if(c.editButton||c.deleteButton){var a="",e="",k="",f="",g="",h="",l="";0===
d.find("th.tabledit-toolbar-column").length&&d.find("tr:first").append('<th class="tabledit-toolbar-column"></th>');c.addButton&&(h='<button type="button" class="tabledit-add-button '+c.buttons.add["class"]+'" style="float: none;">'+c.buttons.add.html+"</button>",l='<button type="button" class="tabledit-cancel-button '+c.buttons.cancel["class"]+'" style="float: none;display: none;">'+c.buttons.cancel.html+"</button>");c.editButton&&(a='<button type="button" class="tabledit-edit-button '+c.buttons.edit["class"]+
'" style="float: none;">'+c.buttons.edit.html+"</button>");c.deleteButton&&(e='<button type="button" class="tabledit-delete-button '+c.buttons["delete"]["class"]+'" style="float: none;">'+c.buttons["delete"].html+"</button>",g='<button type="button" class="tabledit-confirm-button '+c.buttons.confirm["class"]+'" style="display: none; float: none;">'+c.buttons.confirm.html+"</button>");c.editButton&&c.saveButton&&(k='<button type="button" class="tabledit-save-button '+c.buttons.save["class"]+'" style="display: none; float: none;">'+
c.buttons.save.html+"</button>");c.deleteButton&&c.restoreButton&&(f='<button type="button" class="tabledit-restore-button '+c.buttons.restore["class"]+'" style="display: none; float: none;">'+c.buttons.restore.html+"</button>");a='<div class="tabledit-toolbar '+c.toolbarClass+'" style="text-align: left;">\n                                           <div class="'+c.groupClass+'" style="float: none;">'+a+e+"</div>\n                                           "+k+"\n                                           "+
l+"\n                                           "+g+"\n                                           "+f+"\n                                       </div></div>";h='<div class="tabledit-toolbar '+c.toolbarClass+'" style="text-align: left;">\n                                           <div class="'+c.groupClass+' pull-right" style="float: none;">'+h+"</div></div></div>";d.find("th.tabledit-toolbar-column").html(h);d.find("tr:gt(0)").append('<td style="white-space: nowrap; width: 1%;">'+a+"</td>")}}},n=
{view:function(b){var e=a(b).parent("tr");a(b).parent("tr").find(".tabledit-input.tabledit-identifier").prop("disabled",!0);a(b).find(".tabledit-input").blur().hide().prop("disabled",!0);a(b).find(".tabledit-span").show();a(b).addClass("tabledit-view-mode").removeClass("tabledit-edit-mode");c.editButton&&(e.find("button.tabledit-save-button").hide(),e.find("button.tabledit-edit-button").removeClass("active").blur());c.addButton&&(e.find("button.tabledit-edit-button").show(),e.find("button.tabledit-delete-button").show(),
e.find("button.tabledit-save-button").hide(),e.find("button.tabledit-cancel-button").hide())},edit:function(b){m.reset(b);var e=a(b).parent("tr");e.find(".tabledit-input.tabledit-identifier").prop("disabled",!1);a(b).find(".tabledit-span").hide();var d=a(b).find(".tabledit-input");d.prop("disabled",!1).show();c.autoFocus&&d.focus();a(b).addClass("tabledit-edit-mode").removeClass("tabledit-view-mode");c.editButton&&(e.find("button.tabledit-edit-button").addClass("active"),e.find("button.tabledit-save-button").show());
a("button.tabledit-add-button").removeClass("active")},add:function(b){m.reset(b);var e=a(b).parent("tr");e.find(".tabledit-input.tabledit-identifier").prop("disabled",!1);a(b).find(".tabledit-span").hide();var d=a(b).find(".tabledit-input");d.prop("disabled",!1).show();c.autoFocus&&d.focus();a(b).addClass("tabledit-edit-mode").removeClass("tabledit-view-mode");c.addButton&&(e.find("button.tabledit-edit-button").hide(),e.find("button.tabledit-delete-button").hide(),e.find("button.tabledit-save-button").show(),
e.find("button.tabledit-cancel-button").show())}},l={reset:function(b){a(b).each(function(){var b=a(this).find(".tabledit-input"),c=a(this).find(".tabledit-span").text();b.is("select")?b.find("option").filter(function(){return a.trim(a(this).text())===c}).attr("selected",!0):b.val(c);n.view(this)})},submit:function(b){!1!==f(c.buttons.edit.action)&&(a(b).each(function(){var b=a(this).find(".tabledit-input");b.is("select")?a(this).find(".tabledit-span").text(b.find("option:selected").text()):a(this).find(".tabledit-span").text(b.val());
n.view(this)}),h=a(b).parent("tr"))}},r={remove:function(b){a(b).parent("tr").remove()},submit:function(b){!1===f(c.buttons.add.action)?r.remove(b):(a(b).each(function(){var b=a(this).find(".tabledit-input");b.is("select")?a(this).find(".tabledit-span").text(b.find("option:selected").text()):a(this).find(".tabledit-span").text(b.val());n.view(this)}),h=a(b).parent("tr"))}},m={reset:function(a){d.find(".tabledit-confirm-button").hide();d.find(".tabledit-delete-button").removeClass("active").blur()},
submit:function(b){m.reset(b);a(b).parent("tr").find("input.tabledit-identifier").attr("disabled",!1);var e=f(c.buttons["delete"].action);a(b).parents("tr").find("input.tabledit-identifier").attr("disabled",!0);!1!==e&&(a(b).parent("tr").addClass("tabledit-deleted-row"),a(b).parent("tr").addClass(c.mutedClass).find(".tabledit-toolbar button:not(.tabledit-restore-button)").attr("disabled",!0),a(b).find(".tabledit-restore-button").show(),q=a(b).parent("tr"),c.restoreButton||a(b).parent("tr").remove())},
confirm:function(b){d.find("td.tabledit-edit-mode").each(function(){l.reset(this)});a(b).find(".tabledit-delete-button").addClass("active");a(b).find(".tabledit-confirm-button").show()},restore:function(b){a(b).parent("tr").find("input.tabledit-identifier").attr("disabled",!1);var e=f(c.buttons.restore.action);a(b).parents("tr").find("input.tabledit-identifier").attr("disabled",!0);!1!==e&&(a(b).parent("tr").removeClass("tabledit-deleted-row"),a(b).parent("tr").removeClass(c.mutedClass).find(".tabledit-toolbar button").attr("disabled",
!1),a(b).find(".tabledit-restore-button").hide(),a(b).parent("tr"))}};p.identifier();p.editable();p.toolbar();c.onDraw();c.deleteButton&&(d.on("click","button.tabledit-delete-button",function(b){if(!0!==b.handled){b.preventDefault();var c=a(this).hasClass("active");a("button.tabledit-add-button").removeClass("active");var d=a(this).parents("td");m.reset(d);c||m.confirm(d);b.handled=!0}}),d.on("click","button.tabledit-confirm-button",function(b){if(!0!==b.handled){b.preventDefault();var c=a(this).parents("td");
m.submit(c);b.handled=!0}}));if(c.restoreButton)d.on("click","button.tabledit-restore-button",function(b){!0!==b.handled&&(b.preventDefault(),m.restore(a(this).parents("td")),b.handled=!0)});c.addButton&&(d.on("click","button.tabledit-add-button",function(b){if(!0!==b.handled){b.preventDefault();if(!a(this).hasClass("active")){l.reset(d.find("td.tabledit-edit-mode"));var e="#"+d.attr("id");if(0===a(a(e+" tbody tr:last").find("td.tabledit-view-mode")).length){var f=!0;a(e+" tbody").html("");var h=
a(e+" thead"),g=a(document.createElement("tr")).attr(c.rowIdentifier,"");a(h.find("th:not(.tabledit-toolbar-column)").get()).each(function(){var b="<td></td>";a(this).text()==c.rowCounter&&(b="<td>1</td>");g.append(b)})}else g=a(e+" tbody tr:last").clone(),h=parseInt(g.find(".tabledit-span.tabledit-identifier").text()),h++,g.find(".tabledit-span.tabledit-identifier").text(h),g.find(".tabledit-input.tabledit-identifier").val(h),a(".tabledit-span:not(.tabledit-identifier)",g).text(""),a(".tabledit-input:not(.tabledit-identifier)",
g).val("");g.appendTo(e);f&&(p.identifier(),p.editable(),p.toolbar(),f=!1);a(a(e+" tbody tr:last").find("td.tabledit-view-mode").get().reverse()).each(function(){n.add(this)});a(e+" button.tabledit-add-button").addClass("active")}b.handled=!0}}),d.on("click","button.tabledit-save-button",function(b){!0!==b.handled&&(b.preventDefault(),a("button.tabledit-add-button").hasClass("active")?r.submit(a(this).parents("tr").find("td.tabledit-edit-mode")):l.submit(a(this).parents("tr").find("td.tabledit-edit-mode")),
a("button.tabledit-add-button").removeClass("active"),b.handled=!0)}),d.on("click","button.tabledit-cancel-button",function(b){!0!==b.handled&&(b.preventDefault(),r.remove(a(this).parents("tr").find("td.tabledit-edit-mode")),a("button.tabledit-add-button").removeClass("active"),b.handled=!0)}));c.editButton?(d.on("click","button.tabledit-edit-button",function(b){if(!0!==b.handled){b.preventDefault();var c=a(this),f=c.hasClass("active");l.reset(d.find("td.tabledit-edit-mode"));f||a(c.parents("tr").find("td.tabledit-view-mode").get().reverse()).each(function(){n.edit(this)});
b.handled=!0}}),d.on("click","button.tabledit-save-button",function(b){!0!==b.handled&&(b.preventDefault(),l.submit(a(this).parents("tr").find("td.tabledit-edit-mode")),b.handled=!0)})):(d.on(c.eventType,"tr:not(.tabledit-deleted-row) td.tabledit-view-mode",function(a){!0!==a.handled&&(a.preventDefault(),l.reset(d.find("td.tabledit-edit-mode")),n.edit(this),a.handled=!0)}),d.on("change","select.tabledit-input:visible",function(b){!0!==b.handled&&(l.submit(a(this).parent("td")),b.handled=!0)}),a(document).on("click",
function(a){var b=d.find(".tabledit-edit-mode");b.is(a.target)||0!==b.has(a.target).length||l.reset(d.find(".tabledit-input:visible").parent("td"))}));d.on("keyup",function(a){var b=d.find(".tabledit-input:visible"),f=d.find(".tabledit-confirm-button");if(0<b.length)b=b.parents("td");else if(0<f.length)b=f.parents("td");else return;switch(a.keyCode){case 9:c.editButton||(l.submit(b),n.edit(b.closest("td").next()));break;case 13:l.submit(b);break;case 27:l.reset(b),m.reset(b)}});return this}})(jQuery);